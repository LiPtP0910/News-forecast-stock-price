# News-forecast-stock-price
基於新聞文本採礦的股市波動
  - 動機與目標:
   多數股票投資者有本職工作，無法時刻專注新聞大事，我想建立一個監測新聞的系統，提醒投資客該分析的時機，避免投資者浪費時間精力。
   因此我設計由鉅亨網財經新聞資料，預測隔天股價波動的模型。以便使用者由可能波動判斷是否要介入。
  - 研究方法:
    $P_t$為 t 天的股價，已知 $\ln(P_t/P_{t-1})$ 轉換會變成常態，因此將股價轉換成$\text{abs}(\ln(P_t/P_{t-1}))$，關注波動率。
    預測目標為$ln(轉換收盤價/隔天轉換開盤價)$，而驗證時會轉換回來。
    爬下新聞後，斷詞放LDA分$43$類主題。
    統計每個字或關鍵字在小和大股波動下在DelayDay天內的統計差異作權重，加權完得該文章權重。
    抓出各類主題機率大的文章中大權種總量多的主題為討論主題。
    在討論主題的每天每篇文章權重*文章主題機率並加權，即為每天各主題討論程度的指標，送入模型。
    比較模型權重是否用文章的每個字或關鍵字設計權重，參數有無過去資料，與GRU、LSTM、 STFT-CNN和LSTM雙通道三種模型，在不同DelayDay下進行比較，此外也用新聞權重推薦使用者重要新聞。
  - 結果:
    * 最好結果為用文章每個字，有放過去資料，LSTM，DelayDay3~5天，和只用股價訓練的天真模型相比誤差改善81.8%，實際轉換開盤價預測波動MSE誤差9.790285e-06，預測圖形如下，除可能因為漲跌停沒納入討論使偶而高估外，大致貼合。
<img width="1309" height="716" alt="image" src="https://github.com/user-attachments/assets/dfbf7ddc-f527-4225-ac2c-d796b780eea0" />

    * 推薦新聞大致合理，重要度隨推薦順序遞減。
  - 收穫:
    * 觀察目標資料，進行恰當轉換，結果上預測轉換開盤價用設計的方式比直接預測多改善5成。
    * 從千篇新聞提取出洽當的數值特徵，使RNN模型可以使用計算。
    * 獨力完成專題發想、設計

# 基於新聞文本採礦的股市波動研究

## 計畫摘要 (Abstract)

本研究利用爬蟲技術收集2021~2024年的台灣大盤資料和鉅亨網財經新聞，旨在探究新聞報導對股價波動的影響。研究方法上，首先將股價進行對數正態轉換並取絕對值，接著使用潛在狄利克雷分配(LDA)為新聞分類並設計關鍵字和文章兩種影響權重，計算每日的新聞主題影響指標，再進行相應的時間序列轉換後送入深度學習模型。模型設計分為三大類：GRU和注意力機制的LSTM和STFT-CNN和LSTM雙通道，輸入參數則分為「新聞加過去資料」和「僅新聞資料」兩種情境。模型目標為估計當日開盤價相對前一日收盤價的比值取ln，透過比較預測開盤價與實際開盤價的均方誤差(MSE)進行模型評估。此外也提供使用者當天重要新聞。實驗結果中最佳預測MSE為9.56e-06，和天真模型相比改善81.8%。文章權重表現較好。

**關鍵詞**: 股價波動、潛在狄利克雷分配(LDA)、門控循環單元(GRU)、STFT、長短期記憶網絡(LSTM)

## 目錄 (Contents)

1. [前言 (Introduction)](#前言-introduction)
2. [研究動機與研究問題 (Motivation and Research Problem)](#研究動機與研究問題-motivation-and-research-problem)
3. [研究方法與步驟 (Research Method)](#研究方法與步驟-research-method)
4. [結果及討論 (Research Results and Conclusions)](#結果及討論-research-results-and-conclusions)
5. [參考文獻 (References)](#參考文獻-references)

## 前言 (Introduction)

### 研究領域概述

隨著金融市場資訊量激增及大數據技術的迅速發展，利用新聞文本預測股價波動成為金融科技研究中的熱門課題。該領域主要探討新聞資訊如何透過反映市場情緒與重大事件，進而影響股票價格與報酬率。早期的研究著重於從傳統媒體（如報紙專欄）中提取情緒指標，證明負面新聞對股價下跌具有顯著預測能力[1][2]，而正面報導則往往與市場上行相關。此後，隨著文本挖掘與自然語言處理技術（NLP）的發展，研究者開始採用統計學方法、機器學習算法（例如支持向量機，SVM）及深度學習模型（如LSTM及Transformer）來處理大量新聞數據，以提高預測準確度[3][4]。

### 文獻回顧

#### 文本挖掘方法在新聞預測中的應用

早期針對新聞與股市走勢關係的研究多採用支持向量機（SVM）與支持向量回歸（SVR），以文本挖掘技術處理中文或英文財經新聞。例如，Xie和Jiang（2019）在《Stock Market Forecasting Based on Text Mining Technology: A Support Vector Machine Method》中，利用專域停用詞與情緒詞典，成功將新聞文本轉化為數字特徵，進而預測股市走勢[5]。此類方法通過參數優化策略改善預測效果，證明新聞資訊對於股票趨勢具有顯著影響。隨著深度學習技術的快速普及，研究者轉向使用長短期記憶網絡（LSTM）捕捉新聞信息中的時間依賴性[6][7]。

#### 台股及區域市場實證

針對台灣市場的實證研究亦逐步興起。例如，《台股股價方向可預測性之研究》針對台灣股票市場的技術與經濟指標進行實證檢驗，證實特定變數能顯著預測股價走勢[8]；而《新聞情緒指標與臺灣加權股價指數之關係》則利用中文報紙數據構建正負向情緒指標，探討其與市場收益率間的關係，發現負向情緒的預測效果顯著，且在實際交易策略中具有應用潛力[9]。  

另外，基於市場波動性分析，部分研究採用GARCH模型對股市價格波動性進行解釋，如《基于GARCH模型股市价格的波动性分析》指出，GARCH族模型能有效捕捉收益率的波動性特徵，並為預測及風險管理提供依據[10]。而同樣用LDA分析新聞預測股票的研究顯示其漲跌預測成功率達54.513%[11]，另有研究使用注意力機制分析新聞後以LSTM預測匯率，其誤差MSE為0.306[12]。



## 研究動機與研究問題 (Motivation and Research Problem)

### 研究問題

本研究將以新聞為參考資料探究大盤的波動程度，股票波動的定義採用 $\text{abs}(\ln(P_t/P_{t-1}))$，其中$P_t$為t天的股價。此定義基於Fama(1965)的研究[13]，證明了 $\ln(P_t/P_{t-1})$ 符合常態分布的特性。此轉換不僅使數據更符合統計分析要求，同時也符合金融理論中關於股價波動的標準定義。
### 研究背景與動機

台灣有高達約53%的人口擁有交易帳戶，然而多數投資者難以持續關注新聞動態及股票波動情況。因此，本研究旨在設計一個自動化模型，能夠捕捉新聞內容並評估潛在的市場波動，當預測到重大波動時，提醒使用者關注可能的買賣時機，並提供使用者該看哪幾篇新聞。

有別於多數研究著重於預測漲跌方向，本研究認為每日的輕微漲跌對投資決策影響有限，唯有當波動幅度達到一定程度時，才值得投資者特別關注。本研究並非期望模型能完全取代人為判斷，而是希望它能作為一個持續監測市場訊息的輔助工具，適時提醒投資者何時需要介入決策，並提供重要的新聞供使用者觀看。
### 波動率預測的理論基礎

從理論上，Andersen與Bollerslev(1998)[14]指出 $E[|r_t|]=\sqrt{\pi/2}\sigma_t$（其中 $\sigma_t$ 為真實波動率，$r_t$為$\ln(P_t/P_{t-1})$，其中$P_t$為t天的股價）。波動率的準確預測在資產定價、衍生性商品定價（如選擇權定價）以及投資組合最佳化中扮演關鍵角色。例如，在布萊克-斯科爾斯選擇權定價模型（Black-Scholes）中，波動率直接決定了選擇權價格。。

### 研究問題與目標

本研究聚焦於股票波動的預測，特別是開盤價的波動（因開盤價代表這天人們對股價的預期，此外波動通常較大更有研究意義）。考慮到突發性的大幅波動往往源於外部因素，而這些因素通常可在新聞報導中找到相關線索，本研究將探討如何利用新聞內容預測大盤開盤價的波動。在此，股票波動定義為 $\text{abs}(\ln(P_t/P_{t-1}))$，其中 $P_t$ 為第 $t$ 天的開盤價。

本研究的主要目標為：
1. 建立新聞文本與股價波動間的關聯模型
2. 探討不同深度學習架構在波動預測中的效能差異
3. 評估純新聞資料與結合歷史價格資料的預測效果比較
4. 為使用者建議新聞

本研究利用前幾日的新聞資料預測次日的股價波動，訓練資料設定為2021到2024年，驗證資料為2024到2025年。
## 研究方法與步驟 (Research Method)
### 3.1 資料收集與預處理

#### 3.1.1 數據來源
- 利用爬蟲技術從台灣証券交易所獲取2021到2025年大盤數據
- 從鉅亨網收集2021到2025年每日的所有財經新聞報導

#### 3.1.2 數據預處理
- 對每日大盤數據取 $\text{abs}(\ln(P_t/P_{t-1}))$ 進行波動轉換
- 對新聞文本使用結巴分詞工具(全模式)進行斷詞
- 刪減TF-IDF值小於0.0015的低頻詞彙和常見過濾字，以減少噪音

### 3.2.1 LDA主題建模
利用潛在狄利克雷分配(Latent Dirichlet Allocation, LDA)[15]對2021到2024年的新聞進行主題建模：
- 嘗試40~45個主題數並比較其連貫性(coherence, c_v)
- 最終選定43個主題作為分類標準
- 使用訓練好的模型對2024到2025年的新聞進行分類
### 為新聞賦予分類權重

#### 為新聞賦予權重
因為每篇新聞的重要性應該不同，我想對每天新聞賦予權重，代表新聞的影響性  
因為我們是當天所有新聞對應(預測)隔天的開盤價，無法構造出新聞對應開盤價的直接對應，所以我改為統計每篇新聞在開盤價隔天開盤價的分布特徵  
而新聞我由兩種方式擷取討論特徵    
我相信影響性可由討論議題所給出，而在鉅亨網有提供新聞關鍵字代表討論議題，我相信關鍵字在不同開盤價區間的分布有所不同，我由分布差異計算出該關鍵字的影響性  
1. 定義波動：將整體波動的45分位數以下的天數定義為小波動，55分位數以上的天數定義為大波動  
2. 定義 OFFSET_DAYS 為所有新聞影響的天數   
**方式一：基於關鍵字的影響權重**
3. 基於每篇新聞提供的關鍵字：
   - 篩選出現在25篇以上新聞的關鍵字
   - 收集新聞發布後 OFFSET_DAYS 內關鍵字對應的波動類別和波動數值
4. 為每個關鍵字定義四種權重：
   - "weight": $(大波動次數-小波動次數)/(總關鍵字出現次數 \times \text{OFFSET\_DAYS})$  
   代表在給定限制條件大小波動下分布期望數量的差異
   - "p_value": 使用費雪精確檢定（Fisher's Exact Test）[16]計算大波動和小波動數量是否有顯著差異的 p-value，再轉換為 $\text{sign(weight)} \times (-\ln(\text{p\_value}))$（p-value 越小其數值越大，sign(weight)代表是趨向大波動還是小波動） 
   為判斷給定限制條件大小波動下分布差異程度
   - "gw": 計算關鍵字後 OFFSET_DAYS 內的波動數值的幾何平均 keyword_geo，以及整體的幾何平均 global_geogw，帶入 $\exp(2 \times |\text{keyword\_geo}/\text{global\_geogw}-1|)-1$  
   為討論關鍵字的對應數值的幾何平均(因為轉換是乘法關係，所以用幾何平均)和全局幾何平均的比值
   - "wp": $\text{weight} \times ((-\log(\text{p\_value}))^2) \times \text{abs(gw)}$    
   因為實驗得到由p_value得到的結果比較好，所有p_value的影響性成兩倍，而abs(gw)是為了避免負負得正  

我相信新聞的所有關鍵字，代表該新聞有討論到的主題，而新聞的影響性就是討論主題的合  

5.  對於每篇新聞，搜尋每新聞的關鍵字，分別將每個關鍵字的影響性相加為該新聞的影響性

**方式二：基於文章每字的影響權重**  
我相信整篇新聞的影響性可以由每篇新聞的每個字的影響性相加所得到，我先討論每個字的影響性(對於以每一句為單位討論，因為前面所說要統計每篇新聞在開盤價隔天開盤價的分布特徵，而句子基本不會重複，所以無法統計，因而以每個字為討論單位) 

3. 基於每篇新聞提供的關鍵字：
   - 篩選出現在50篇以上新聞的關鍵字
   - 收集新聞發布後 OFFSET_DAYS 內關鍵字對應的波動類別和波動數值
4. 為每個關鍵字定義四種權重：
    但因為用每個字，我怕突出常見的沒意義的字大幅影響最後加權值所以我定義combinedCtfidf，討論在主題下和在大小波動下的重要性  
    在主題ctfidf中，我將每篇文章每個字的字頻乘上主題機率，跨文章相加，得每個主題下的字出現量，在不同主題的字出現量計算ctfidf(參考[16]分別計算每類ctfidf，並將tf歸一化)，同時計算每字在每主題下的出現機率，將各主題的ctfidf*個主題機率得topicScore(該字的主題分類下的重要性)  
    在波動ctfidf中，我將在大小波動每個字的字頻，跨文章相加，得在波動分類下的字出現量，在不同主題的字出現量計算tfidf(參考[16]分別計算每類tfidf，並將tf歸一化)，同時計算每字在波動分類下的出現機率，將各主題的tfidf*各波動分類機率得waveScore(該字的波動分類下的重要性)  
   -"combinedCtfidf":$topicScore * waveScore$  
   -  該字在主題和波動總合的重要性
   - "weight": $(大波動次數-小波動次數)/(總關鍵字出現次數 \times \text{OFFSET\_DAYS})*combinedCtfidf$  
   代表在給定限制條件大小波動下分布期望數量的差異和重要性的總和考量
   - "p_value": 使用費雪精確檢定（Fisher's Exact Test）[16]計算大波動和小波動數量是否有顯著差異的 p-value，再轉換為 $\text{sign(weight)} \times (-\ln(\text{p\_value}))*combinedCtfidf$（p-value 越小其數值越大，sign(weight)代表是趨向大波動還是小波動）  
   為判斷給定限制條件大小波動下分布差異程度和重要性的總和考量
   - "gw": 計算關鍵字後 OFFSET_DAYS 內的波動數值的幾何平均 keyword_geo，以及整體的幾何平均 global_geogw，帶入 $(\exp(2 \times |\text{keyword\_geo}/\text{global\_geogw}-1|)-1)*combinedCtfidf$  
   為討論關鍵字的對應數值的幾何平均(因為轉換是乘法關係，所以用幾何平均)和全局幾何平均的比值和重要性的總和考量
   - "wp": $\text{weight} \times ((-\log(\text{p\_value}))^2) \times \text{abs(gw)}*combinedCtfidf$  
   因為實驗得到由p_value得到的結果比較好，所有p_value的影響性成兩倍並總和考量重要性  

我相信新聞的所有字，代表該新聞有討論到的內容，而新聞的影響性就是討論內容的合

5.  對於每篇新聞，搜尋每新聞的關鍵字，分別將每個字的影響性相加為該新聞的影響性(重複出現的字，影響性重複計算)

6. 我覺得正和負(偏向大波動和偏向小波動)不能相加算。所以每篇文章分別有正和負權重合
### 計算每天分類權重

#### 篩選討論主題權重
因為在影響力計算因為在影響力計算
1. 計算權重分類別的正值和負值，以及主題的情況，每天共有43種主題×4種權重×2種正負個參數
2. 計算新聞在主題占比大於0.1下的正負權重各出現數量 total_days，並記錄在此主題之下，權重取絕對值的大於前紀錄的絕對值75分位數數量day_set
3. 找出符合 $\text{days\_set}/\text{total\_days} > 0.3$ 且 total_days 大於總天數*0.3的參數
4. 在2021到2024年和2024到2025年的資料中分別篩選出參數，取交集得到最終篩選參數
5.將參數進行 $\text{abs}(\ln(P_t/P_{t-1}))$ 其中P_t為該參數數值轉換

#### 計算每天新聞影響

假設新聞影響呈指數遞減趨勢，選取在 OFFSET_DAYS 時機率大於0.5的衰減參數 $\alpha$，將前面篩選的參數，以每篇新聞向後衰減參數的指數遞減 $\alpha$ 相加，得到每天各類別的新聞影響。

#### 計算每天新聞影響參數轉換

將前一步驟計算的每天影響取 $\ln(P_t/P_{t-1})$，其中 $P_t$ 為該參數在第 $t$ 天的新聞影響，以突出資料的變化率。

### 模型計算

#### 資料整理

- 定義"收盤_ratio"為該天開盤指數_lognormal_abs除以前一天收盤指數_lognormal_abs
- 定義"開盤_ratio"為開盤指數_lognormal_abs代入 $ln(P_t/P_{t-1})$，其中 $P_t$ 為該參數在第 $t$ 天的開盤指數_lognormal_abs

#### 輸入參數

研究設計兩種輸入情境：
1. 僅使用最終篩選的新聞參數（僅新聞）
2. 加入開盤_ratio、收盤_ratio、開盤指數_lognormal_abs、收盤指數_lognormal_abs等歷史資料 

研究設計新聞的兩種參數情境：   

1. 只有放入進行$\text(\ln(P_t/P_{t-1}))$ (其中P_t為主題影響力參數)轉換後的參數  
2. 放入進行$\text(\ln(P_t/P_{t-1}))$ (其中P_t為主題影響力參數)轉換後的參數和原始參數  


#### 模型設計

以30天數據輸入預測1天結果

**共同參數**:
- hidden_size = 256
- num_layers = 3
- learning_rate = 0.0001
- batch_size = 64
- optimizer = optim.Adam(model.parameters(), lr=learning_rate)
- scheduler = optim.lr_scheduler.ReduceLROnPlateau(optimizer, 'min', patience=5, factor=0.5, verbose=True)

**模型一**:   
GRU [[17]](dropout_out=0.5)，取時間步最後一步加layer_norm和dropout_out=0.5  
**模型二**:   
LSTM[[18]](dropout_out=0.5)，加注意力機制(num_heads = 3, dim_k = 9, dim_v = 9)[19]，取時間步最後一步加layer_norm和dropout=0.5

**模型三**  
 STFT-CNN和LSTM雙通道，參考[19][20]，STFT-CNN通道參數進行STFT(seq_len=30,nperseg=16, noverlap=8)，然後用捲機加resNet[21](channel為324,128,64,16,4，中間接resNet 5層)，LSTM層同模型二，對雙通道最後一步加layer_norm和dropout=0.5，合併後連接後加resNet 10層，最後殘差預測5層(全連接層預測後，第二層起，輸入加入第一層輸出(才較好以第一層為基礎進行預測)，後接LayerNorm,tanh，輸出加上第一層輸出，以此類推)

因為我預測前天收盤價和隔天開盤價得比值  
![alt text](image-5.png)  
極端值差異很大，容易訓練預測為水平線
所以進行log轉換，改預測ln(收盤價/隔天開盤價)  
![alt text](image-6.png)  
**模型損失函數**:  
$3*sl+3*mseLoss+1e7*mseLossT+10*dl$  
-sl 將未轉換數據的絕對值誤差乘上exp(0.1*真實值)  
-mseLoss 算未轉換數據的mse誤差  
-mseLossT 算轉換數據後的mse誤差  
-dl 算未轉換數據的DILATE[22]Loss誤差(設計為可精準預測時間序列的瞬間變化)

**輸出**:   
output 為ln(收盤_ratio)的估計  
這樣只要估計前天下午收盤到當天開盤的變化，起始點比較近，而且也可以放大我的估計輸出在1四周而非很小的開盤指數_lognormal_abs  
**輸出轉換**:  
每時間刻輸出帶入exp後乘上一刻收盤指數_lognormal_abs，作為開盤指數_lognormal_abs的估計  



**驗證損失函數**:  
轉換後輸出和開盤指數_lognormal_abs的MSE誤差  

**早停**:  
找到最好的驗證損失函數後，若100次迭代仍無改善則停止訓練  

**學習率**  
動態調整學習率，ReduceLROnPlateau(optimizer, 'min',patience=20,factor=0.5)，測試對象為測試集誤差  

## 結果及討論 (Research Results and Conclusions)

### 實驗結果

#### 天真模型（基準）

直接用過去資料跑LSTM：

![alt text](image-7.png)  

橫軸為預測的第幾天，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差

- Error Ratio in Training Variance: 1.3439
- 實際開盤價預測波動誤差: 5.2497059224831943e-05
- 輸出呈水平線，未能有效學習變化趨勢

#### 過去資料加新聞的LSTM天真模型

![alt text](image-8.png)  
橫軸為預測的第幾天，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差

- Error Ratio in Training Variance:1.3469
- 實際開盤價預測波動誤差: 5.2752e-05
- 輸出近似水平線，未能有效學習變化趨勢，但趨勢比天真模型明顯

#### GRU(模型一)

![alt text](image-9.png)  
橫軸為OFFSET_DAYS的天數，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差  

- GRU模型收斂不穩定  
- 在5~9天時預測佳
- 加過去預測比較準
- 只輸入ratio比較準
- 預測好時有達到誤差1e-5

GRU預測表現較好的情況(以加過去資料參數僅放ratio而關鍵字權重累計offset 7天）：

![alt text](image-10.png)  
橫軸為預測的第幾天，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差
- Error Ratio in Training Variance: 0.2546358043935335
- 實際開盤價預測波動誤差: 9.954782e-06
- 改善比例: 81.1%
- 整體趨勢貼合，但極端值有高估

#### LSTM(模型二)


![alt text](image-11.png)  
橫軸為OFFSET_DAYS的天數，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差  
- lstm模型收斂較gru穩定
- 在4~6天時預測佳
- 參數少時比較不穩定  
   -僅新聞時比較差  
   -參數只加ratio比較差  


LSTM預測表現較好的情況（加過去資料 加原始參數 用關鍵字權重 offset 15)
）：

![alt text](image-12.png)  
橫軸為預測的第幾天，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差

- Error Ratio in Training Variance: 0.2496076459581044
- 實際開盤價預測波動誤差: 9.758211e-06
- 改善比例: 81.14%
- 整體趨勢貼合，但極端值有高估

##### LSTM微小趨勢
圖為最佳情況 加過去 加原始參數 
![alt text](image-13.png)  
- lstm模型預測都相當接近
- 隨著offset增加誤差有減少趨勢  



#### 雙通道(模型三)
![alt text](image-14.png)  
橫軸為OFFSET_DAYS的天數，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差
- 雙通道收斂穩定性在GRU和LSTM之間，會受噪音影響
- 最佳預測還是接近1e-5(沒有以複雜性換取更好的預測)

雙通道預測表現較好的情況(加過去資料 僅用ratio轉換新聞 offset 10 用關鍵字權重)

![alt text](image-15.png)  
橫軸為預測的第幾天，縱軸為預測和實際開盤價\_lognormal_abs的MSE誤差
整體預測值偏低，但波動趨勢有大至抓到

- Error Ratio in Training Variance: 0.25042808076159967
- 實際開盤價預測波動誤差: 9.790285e-06
- 改善比例: 81.3%
- 整體趨勢貼合，但極端值有高估
- 最佳比專注力LSTM好

### 關鍵字權重和文章權重比較
以最穩定的lstm為例  
![alt text](image-16.png)  
- 文章權重大誤差值較低  
文章權重在噪音層面比較少
- 文章權重預測誤差更低  
文章權重可學習的資訊更多

雙通道預測表現較好的情況(圖為僅新聞 加原始參數 offset 2 用文章權重)  
![alt text](image-17.png)  
- Error Ratio in Training Variance: 0.24477018405997042
- 實際開盤價預測波動誤差:9.569094e-06
- 改善比例:81.8%
- 整體趨勢貼合，但極端值有高估
- 誤差比前面關鍵字權重低一些

### 為使用者建議新聞
由我對於新聞影響力權重的設計，我可以用以訓練完的權重預測新一天的新聞，看哪些影響力(絕對值)大，推薦給使用者權重大的新聞，讓使用者可以知道是發生什麼事導致股價波動，不用格外找新聞  
我新聞權重是用總和權重(wp)，代表綜合的結果  
以2024-12-02為例(開盤價波動0.022709037)    
關鍵字權重:  
在 2024-12-02 這一天，affect value 絕對值最大的前 10 篇文章標題：
1. 德國航運巨擘赫伯羅德第四季獲利看淡
2. 美股早盤主要指數漲跌互現 投資人謹慎應本周多項經濟數據
3. 英特爾執行長基辛格宣告退休
4. 北基油品建案綠能三大引擎挹注 明年加油站數量拚全台第5
5. Uber印度克什米爾推出水上叫船服務
6. 歐元區11月製造業PMI終值報452 澆熄經濟復甦希望
7. 亞馬遜將試驗AI設計物質除碳
8. 第一金法說公股投信三合一第一金驚看報紙才知道 拋結親3要件
9. 貝萊德接近完成收購私人信貸商HPS
10. OpenAI考慮植入廣告 尋找新收入來源

文章權重:  
在 2024-12-02 這一天，影響力最大的前 10 篇文章標題：  
1. 德國航運巨擘赫伯羅德第四季獲利看淡  
2. 美股早盤主要指數漲跌互現 投資人謹慎應本周多項經濟數據
3. 英特爾執行長基辛格宣告退休
4. 北基油品建案綠能三大引擎挹注 明年加油站數量拚全台第5
5. Uber印度克什米爾推出水上叫船服務
6. 歐元區11月製造業PMI終值報452 澆熄經濟復甦希望
7. 亞馬遜將試驗AI設計物質除碳
8. 第一金法說公股投信三合一第一金驚看報紙才知道 拋結親3要件
9. 貝萊德接近完成收購私人信貸商HPS
10. OpenAI考慮植入廣告 尋找新收入來源

兩者權重抓出的前10大新聞皆相同，但順序有些微差異，而以直觀來看，前幾新聞確實會影響股價波動，而且影響力隨順序而下降

### 討論


- ratio轉換後資訊量比較大
- 未進行轉換噪音較大，如沒專注力機制，容易被影響
- 過去訊息可以改善預測，但有噪音的問題
- 最佳預測值都接近1e-5
- 好的預測曲線接近，但極端值有所高估，猜測可能是因為沒預測到漲跌停
- offset在5時準確，後面隨著變大資訊量增加但噪音也變大，可能說明主要影響有5天，而前期不好可能是因為樣本不足，後面雖然樣本變多，但影響性有變弱
- 文章權重更佳(在噪音和資訊量上都比較好)
- 雙通道模型更複雜但結果沒更好，LSTM複雜度恰當
#### 未來展望
- 模型能對極端值做更好的預測
- 加入常見的股價基本面等指標進行預測
- 探索更長時間序列的影響關係，特別是不同類型新聞的長短期影響差異
- 將模型擴展至產業指數和個股層面，探討新聞對不同市場板塊的差異化影響


## 參考文獻 (References)

[1] Tetlock, P. C. (2007). "Giving Content to Investor Sentiment: The Role of Media in the Stock Market." *The Journal of Finance*, 62(3), 1139–1168.  
[2] García, D. (2013). "Sentiment during Recessions." *The Journal of Finance*, 68(3), 1267–1300.  
[3] Bert Lee, "看新聞，預測股票趨勢(上)" [Medium]  
[4] Xie, Y., & Jiang, H. "Stock Market Forecasting Based on Text Mining Technology: A Support Vector Machine Method," arXiv, 2019  
[5] Zhao, Y., Du, H., Liu, Y., Wei, S., Chen, X., Zhuang, F., Li, Q., Liu, J., & Kou, G. "Stock Movement Prediction Based on Bi-typed Hybrid-relational Market Knowledge Graph via Dual Attention Networks," arXiv, 2022  
[6] Liu, X., Huang, H., Zhang, Y., & Yuan, C. "News-Driven Stock Prediction With Attention-Based Noisy Recurrent State Transition," arXiv, 2020.   
[7] Xinyi Li, Yinchuan Li, Hongyang Yang, Liuqing Yang, Xiao-Yang Liu,"DP-LSTM: Differential Privacy-inspired LSTM for Stock Prediction Using Financial News"  
[8] 連春紅,李政峯,林彥宏 "台股股價方向可預測性之研究：以AI相關概念股為例"  
[9] 《新聞情緒指標與臺灣加權股價指數之關係》，中央研究院人文社會科學研究中心  
[10] 《基于GARCH模型股市价格的波动性分析》，漢斯出版社  
[11] Jinxiao Wang, Jianxin Shi, Dexin Han, Xiaoyu Zhao, "Internet Financial News and Prediction for Stock Market: An Empirical Anysis of Tourism Plate Baesd on LDA and SVM"  
[12] 王姿華, 葉向原, "利用階層式注意力深度學習模型從金融新聞預測匯率波動"  
[13] Fama (1965), 《The Behavior of Stock Market Prices》  
[14] Andersen, T. G., & Bollerslev, T. (1998) 《Answering the Skeptics: Yes, Standard Volatility Models Do Provide Accurate Forecasts》  
[15] David M. Blei, Andrew Y. Ng, Michael I. Jordan; 3(Jan):993-1022, 2003.《Latent Dirichlet Allocation》 
[16]Maarten Grootendorst,2022,BERTopic: Neural topic modeling with a class-based TF-IDF procedure
 
[16] Fisher, R. A. (1922). On the Interpretation of χ² from Contingency Tables, and the Calculation of P. Journal of the Royal Statistical Society, 85(1), 87–94.  
[17] Kyunghyun Cho, Bart van Merriënboer, Caglar Gulcehre, Dzmitry Bahdanau, Fethi Bougares, Holger Schwenk, Yoshua Bengio《*Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation*》  
[18] Hochreiter, S., & Schmidhuber, J. (1997). Long Short-Term Memory. Neural Computation, 9(8), 1735–1780. 
[19]Zhang, Y., & Li, X. (2020). A Novel Stock Price Prediction Model Based on STFT-CNN-LSTM 
[19] Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., & Polosukhin, I. (2017). *Attention is All You Need*. Advances in Neural Information Processing Systems, 30
[20]Wang, J., Liu, W., & Li, J. (2019). Stock Market Prediction Based on STFT and CNN–LSTM Hybrid Model
[21]Kaiming He, Xiangyu Zhang, Shaoqing Ren, Jian Sun,2015,Deep Residual Learning for Image Recognition
[22]Vincent Le Guen 與 Nicolas Thome,Shape and Time Distortion Loss for Training Deep Time Series Forecasting Models
